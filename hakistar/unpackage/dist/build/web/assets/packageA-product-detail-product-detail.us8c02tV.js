import{d as a,o as e,a as l,c as s,e as t,f as c,h as u,i,w as o,j as r,l as n,m as d,F as p,k as _,t as f,V as v,z as m,O as g,E as b,S as h,q as k,p as w,H as y,u as C,A as x,B as S}from"./index-HfrO64ci.js";import{g as j,p as z}from"./index.qscmTMIl.js";import{u as O,P as F}from"./product-spec-popup.B3yT7R12.js";const B=S(a({__name:"product-detail",setup(a){const S=O();e((a=>{B.value=JSON.parse(a.product),N(),S.setSpec(""),S.setCount(1)}));const B=l({}),J=l([]),N=async()=>{try{const a=await j("/sel/detail",{id:B.value.id});J.value=a}catch(a){console.error("失败")}},P=l(!1),q=()=>{P.value=!0},A=()=>{P.value=!1},E=s((()=>S.specText)),H=s((()=>S.count)),I=s((()=>S.total)),T=async()=>{if(E.value)try{await z("/cart/addCart",{product_id:B.value.id,name:B.value.name,price:B.value.price,count:H.value,spec:E.value,main_pic:B.value.main_pic});v({title:"加购成功",icon:"success"}),S.setSpec(""),S.setCount(1),A()}catch(a){console.error(a)}else q()},V=()=>{if(E.value){let a=[{count:H.value,main_pic:B.value.main_pic,name:B.value.name,price:I.value,product_id:B.value.id,spec:E.value}];m({url:"/packageB/order/order?selPro="+JSON.stringify(a)})}else q()},D=()=>{g({url:"/pages/index/index"})},G=()=>{b("token")?m({url:"/pages/cart/cart"}):m({url:"/pages/login/login"})};return(a,e)=>{const l=C,s=x,v=h,m=k,g=w,b=t(c("up-icon"),y);return u(),i(g,{class:"product-detail"},{default:o((()=>[r(v,{class:"swiper",circular:"","indicator-dots":"",autoplay:"",interval:3e3,duration:1e3},{default:o((()=>[(u(!0),n(p,null,d(J.value,(a=>(u(),i(s,{key:a.id},{default:o((()=>[r(l,{src:a.img_url,mode:"aspectFill"},null,8,["src"])])),_:2},1024)))),128))])),_:1}),r(g,{class:"product-info"},{default:o((()=>[r(g,{class:"price-box"},{default:o((()=>[r(m,{class:"price"},{default:o((()=>[_("￥"+f(B.value.price),1)])),_:1}),r(m,{class:"original-price"},{default:o((()=>[_("￥"+f(B.value.o_price),1)])),_:1})])),_:1}),r(g,{class:"title"},{default:o((()=>[_(f(B.value.name),1)])),_:1}),r(g,{class:"desc"},{default:o((()=>[_(f(B.value.desc),1)])),_:1})])),_:1}),r(g,{class:"spec-section",onClick:q},{default:o((()=>[r(m,{class:"label"},{default:o((()=>[_("规格")])),_:1}),r(g,{class:"selected-spec"},{default:o((()=>[r(m,null,{default:o((()=>[_(f(E.value||"请选择规格"),1)])),_:1}),r(b,{name:"arrow-right",size:"20",color:"#999"})])),_:1})])),_:1}),r(g,{class:"detail-section"},{default:o((()=>[r(g,{class:"section-title"},{default:o((()=>[_("商品详情")])),_:1}),r(g,{class:"detail-content"},{default:o((()=>[(u(!0),n(p,null,d(J.value,(a=>(u(),i(l,{key:a.id,mode:"widthFix",class:"detail-image",src:a.img_url},null,8,["src"])))),128))])),_:1})])),_:1}),r(g,{class:"bottom-bar"},{default:o((()=>[r(g,{class:"left-btns"},{default:o((()=>[r(g,{class:"icon-btn",onClick:D},{default:o((()=>[r(b,{name:"home",size:"40",color:"#666"}),r(m,null,{default:o((()=>[_("首页")])),_:1})])),_:1}),r(g,{class:"icon-btn",onClick:G},{default:o((()=>[r(b,{name:"shopping-cart",size:"40",color:"#666"}),r(m,null,{default:o((()=>[_("购物车")])),_:1})])),_:1})])),_:1}),r(g,{class:"right-btns"},{default:o((()=>[r(g,{class:"cart-btn",onClick:T},{default:o((()=>[_("加入购物车")])),_:1}),r(g,{class:"buy-btn",onClick:V},{default:o((()=>[_("立即购买")])),_:1})])),_:1})])),_:1}),r(F,{show:P.value,product:B.value,onClose:A,showOk:!0},null,8,["show","product"])])),_:1})}}}),[["__scopeId","data-v-c32f53e4"]]);export{B as default};
