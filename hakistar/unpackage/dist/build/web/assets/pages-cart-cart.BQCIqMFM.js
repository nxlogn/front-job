import{d as e,o as a,a as s,c as t,W as l,e as c,f as u,h as d,i as o,w as r,l as n,m as i,F as f,j as p,k as _,t as v,I as h,z as m,X as k,p as y,q as g,H as b,s as x,V as q,u as C,B as j}from"./index-HfrO64ci.js";import{g as w,p as F}from"./index.qscmTMIl.js";const U=j(e({__name:"cart",setup(e){a((()=>{U()}));const j=s([]),U=async()=>{try{const e=await w("/cart/list");console.log("购物车数据",e),j.value=e.map((e=>({...e,selected:!1})))}catch(e){console.error("获取失败")}},z=t((()=>{let e=0;for(const a of j.value)a.selected&&(e+=Number(a.price));return e.toFixed(2)})),A=t((()=>j.value.filter((e=>e.selected)).length)),B=s(!1);l(j,(()=>{0!==j.value.length?B.value=j.value.length===A.value:B.value=!1}),{deep:!0});const I=()=>{j.value.forEach((e=>{e.selected=!B.value}))},N=t((()=>j.value.filter((e=>e.selected)))),E=()=>{A.value&&m({url:"/packageB/order/order?selPro="+JSON.stringify(N.value)})};return(e,a)=>{const s=c(u("up-checkbox"),k),t=y,l=C,m=g,w=c(u("up-icon"),b);return d(),o(t,{class:"cart-container"},{default:r((()=>[j.value.length>0?(d(),o(t,{key:0,class:"cart-list"},{default:r((()=>[(d(!0),n(f,null,i(j.value,(e=>(d(),o(t,{class:"cart-item",key:e.cart_id},{default:r((()=>[p(t,{class:"checkbox"},{default:r((()=>[p(s,{usedAlone:"",checked:e.selected,"onUpdate:checked":a=>e.selected=a},null,8,["checked","onUpdate:checked"])])),_:2},1024),p(l,{class:"product-img",src:e.main_pic,mode:"aspectFill"},null,8,["src"]),p(t,{class:"product-info"},{default:r((()=>[p(t,{class:"product-name"},{default:r((()=>[_(v(e.name),1)])),_:2},1024),p(t,{class:"product-spec"},{default:r((()=>[_(v(e.spec),1)])),_:2},1024),p(t,{class:"price-quantity"},{default:r((()=>[p(t,{class:"price"},{default:r((()=>[_("￥"+v(e.price),1)])),_:2},1024),p(t,{class:"quantity-control"},{default:r((()=>[p(m,{class:"quantity-label"},{default:r((()=>[_("数量：")])),_:1}),p(t,{class:"quantity-text"},{default:r((()=>[_(v(e.count),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024),p(t,{class:"delete-btn",onClick:a=>{return s=e.cart_id,void x({title:"提示",content:"确定要删除此商品吗?",success:async e=>{if(e.confirm)try{await F("/cart/deleteCart",{cart_id:s}),q({title:"删除成功",icon:"success"}),U()}catch(a){console.error("删除商品失败")}}});var s}},{default:r((()=>[p(w,{name:"trash",size:"20",color:"#999"})])),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:1})):(d(),o(t,{key:1,class:"empty-cart"},{default:r((()=>[p(t,{class:"empty-text"},{default:r((()=>[_("购物车空空如也~")])),_:1}),p(t,{class:"go-shopping"},{default:r((()=>[_("去逛逛!")])),_:1})])),_:1})),p(t,{class:"settlement-bar"},{default:r((()=>[p(t,{class:"select-all"},{default:r((()=>[p(s,{usedAlone:"",checked:B.value,"onUpdate:checked":a[0]||(a[0]=e=>B.value=e),onChange:I},null,8,["checked"])])),_:1}),p(t,{class:"total-info"},{default:r((()=>[p(t,{class:"total-price"},{default:r((()=>[_(" 合计："),p(m,{class:"price"},{default:r((()=>[_("￥"+v(z.value),1)])),_:1})])),_:1}),p(t,{class:"total-desc"},{default:r((()=>[_("不含运费")])),_:1})])),_:1}),p(t,{class:h(["settle-btn",{active:A.value>0}]),onClick:E},{default:r((()=>[_("结算("+v(A.value)+")",1)])),_:1},8,["class"])])),_:1})])),_:1})}}}),[["__scopeId","data-v-78bc9b76"]]);export{U as default};
