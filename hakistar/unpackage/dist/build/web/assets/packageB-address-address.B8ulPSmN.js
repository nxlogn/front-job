import{d as e,o as a,a as l,a5 as s,e as t,f as n,h as o,i as c,w as d,l as u,m as i,F as r,j as f,k as m,t as p,V as _,q as v,p as h,H as g,M as k,a7 as y,R as C,a6 as V,a8 as b,D as w,a9 as x,s as z,aa as j,a0 as U,B as I}from"./index-HfrO64ci.js";import{g as O,p as R}from"./index.qscmTMIl.js";const q=I(e({__name:"address",setup(e){a((e=>{q(),Z.value=e.flag}));const I=l([]),q=async()=>{try{const e=await O("/cart/address");I.value=e}catch(e){console.log(e)}},A=l(!1),B=s([["山东省","北京市","广东省","江苏省"],["青岛市","济南市","威海市","烟台市"],["市南区","市北区","崂山区","李沧区"]]),D=s([["青岛市","济南市","威海市","烟台市"],["北京市"],["广州市","深圳市","珠海市"],["南京市","苏州市","无锡市"]]),F=s([["市南区","市北区","崂山区","李沧区"],["历下区","市中区","槐荫区","天桥区"],["环翠区","文登区","荣成市","乳山市"],["芝罘区","福山区","牟平区","莱山区"],["东城区","西城区","朝阳区","海淀区","丰台区"],["越秀区","海珠区","荔湾区","天河区"],["福田区","罗湖区","南山区","盐田区"],["香洲区","斗门区","金湾区"],["玄武区","秦淮区","建邺区","鼓楼区"],["姑苏区","虎丘区","吴中区","相城区"],["梁溪区","锡山区","惠山区","滨湖区"]]),H=l(null),M=e=>{const{columnIndex:a,value:l,values:s,index:t}=e;if(0===a){H.value.setColumnValues(1,D[t]);const e=P(t,0);H.value.setColumnValues(2,F[e])}else if(1===a){const e=B[0].indexOf(l[0]),a=P(e,t);H.value.setColumnValues(2,F[a])}},P=(e,a)=>{const l=D.map((e=>e.length));let s=0;for(let t=0;t<e;t++)s+=l[t];return s+a},S=e=>{console.log("confirm",e.value),A.value=!1,N.region=e.value},E=()=>{A.value=!1,N.region=[]},G=l(!1),J=l(!1),K=()=>{J.value=!1,G.value=!0},L=()=>{G.value=!1,W()},N=s({name:"",phone:"",region:[],detail:"",is_default:0}),Q=l(null),T=e=>{N.is_default=e.detail.value?1:0},W=()=>{N.name="",N.phone="",N.region=[],N.detail="",N.is_default=0},X=()=>{A.value=!0},Y=async()=>{if(!(N.name.trim()&&N.phone.trim()&&N.region.length&&N.detail.trim()))return void _({title:"地址信息不能为空",icon:"none"});const e={id:J.value?Q.value:null,name:N.name,phone:N.phone,province:N.region[0],city:N.region[1],district:N.region[2],detail:N.detail,is_default:N.is_default};try{await R("/cart/addOrUpdate",e),_({title:J.value?"编辑成功":"新增成功"})}catch(a){console.log(a)}L(),q()},Z=l("");return(e,a)=>{const l=v,s=h,O=t(n("up-icon"),g),D=k,F=y,P=C,W=t(n("up-popup"),V),$=t(n("up-picker"),b);return o(),c(s,{class:"address-page"},{default:d((()=>[I.value.length?(o(),c(s,{key:0,class:"address-list"},{default:d((()=>[(o(!0),u(r,null,i(I.value,(e=>(o(),c(s,{class:"address-item",key:e.id,onClick:a=>(e=>{Z.value&&(j("addressSelected",e),U())})(e)},{default:d((()=>[f(s,{class:"address-info"},{default:d((()=>[f(s,{class:"contact-info"},{default:d((()=>[f(l,{class:"name"},{default:d((()=>[m(p(e.name),1)])),_:2},1024),f(l,{class:"phone"},{default:d((()=>[m(p(e.phone),1)])),_:2},1024),e.is_default?(o(),c(l,{key:0,class:"default-tag"},{default:d((()=>[m("默认")])),_:1})):w("",!0)])),_:2},1024),f(s,{class:"address-detail"},{default:d((()=>[m(p(e.province)+p(e.city)+p(e.district)+p(e.detail),1)])),_:2},1024)])),_:2},1024),f(s,{class:"address-actions"},{default:d((()=>[f(s,{class:"action-btn",onClick:x((a=>(e=>{J.value=!0,Q.value=e.id,N.name=e.name,N.phone=e.phone,N.region=[e.province,e.city,e.district],N.detail=e.detail,N.is_default=e.is_default,G.value=!0})(e)),["stop"])},{default:d((()=>[f(O,{name:"edit-pen",size:"20",color:"#666"})])),_:2},1032,["onClick"]),f(s,{class:"action-btn",onClick:x((a=>{return l=e.id,void z({title:"提示",content:"确认要删除这个地址吗？",success:async e=>{if(e.confirm)try{await R("/cart/deleteAddress",{id:l}),_({title:"删除成功",icon:"success"}),q()}catch(a){console.log(a)}}});var l}),["stop"])},{default:d((()=>[f(O,{name:"trash",size:"20",color:"#666"})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):(o(),c(s,{key:1,class:"empty-state"},{default:d((()=>[f(O,{name:"map",size:"60",color:"#ccc"}),f(l,{class:"empty-text"},{default:d((()=>[m("您还未添加收货地址哦~")])),_:1})])),_:1})),f(s,{class:"add-btn",onClick:K},{default:d((()=>[f(O,{name:"plus",size:"20",color:"#fff"}),f(l,null,{default:d((()=>[m("新增收货地址")])),_:1})])),_:1}),f(W,{show:G.value,closeable:"",class:"wrap",onClose:L},{default:d((()=>[f(s,{class:"address-form"},{default:d((()=>[f(s,{class:"form-title"},{default:d((()=>[m(p(J.value?"编辑地址":"新增地址"),1)])),_:1}),f(s,{class:"form-item"},{default:d((()=>[f(l,{class:"label"},{default:d((()=>[m("收货人")])),_:1}),f(D,{modelValue:N.name,"onUpdate:modelValue":a[0]||(a[0]=e=>N.name=e),placeholder:"请输入收货人姓名",class:"input"},null,8,["modelValue"])])),_:1}),f(s,{class:"form-item"},{default:d((()=>[f(l,{class:"label"},{default:d((()=>[m("手机号")])),_:1}),f(D,{modelValue:N.phone,"onUpdate:modelValue":a[1]||(a[1]=e=>N.phone=e),placeholder:"请输入手机号",type:"number",maxlength:"11",class:"input"},null,8,["modelValue"])])),_:1}),f(s,{class:"form-item",onClick:X},{default:d((()=>[f(l,{class:"label"},{default:d((()=>[m("所在地区")])),_:1}),f(s,{class:"region-display"},{default:d((()=>[N.region.length?(o(),c(l,{key:0},{default:d((()=>[m(p(N.region.join(" ")),1)])),_:1})):(o(),c(l,{key:1},{default:d((()=>[m("请选择所在地区")])),_:1})),f(O,{name:"arrow-right",size:"16",color:"#999",class:"right"})])),_:1})])),_:1}),f(s,{class:"form-item"},{default:d((()=>[f(l,{class:"label"},{default:d((()=>[m("详细地址")])),_:1}),f(F,{modelValue:N.detail,"onUpdate:modelValue":a[2]||(a[2]=e=>N.detail=e),placeholder:"请输入详细地址",class:"textarea"},null,8,["modelValue"])])),_:1}),f(s,{class:"form-item"},{default:d((()=>[f(l,{class:"def"},{default:d((()=>[m("设为默认地址")])),_:1}),f(P,{checked:N.is_default,color:"#ffce2c",onChange:T},null,8,["checked"])])),_:1}),f(s,{class:"form-actions"},{default:d((()=>[f(s,{class:"cancel-btn",onClick:L},{default:d((()=>[m("取消")])),_:1}),f(s,{class:"save-btn",onClick:Y},{default:d((()=>[m("保存")])),_:1})])),_:1})])),_:1})])),_:1},8,["show"]),f($,{show:A.value,ref_key:"uPickerRef",ref:H,columns:B,onConfirm:S,onChange:M,onCancel:E},null,8,["show","columns"])])),_:1})}}}),[["__scopeId","data-v-598e3dc9"]]);export{q as default};
