import{d as a,o as e,C as l,a as s,b as t,e as c,f as o,h as u,l as r,j as n,w as i,F as d,m as p,k as v,t as f,i as g,D as _,E as m,z as y,p as h,G as k,H as w,I as C,u as j,q as b,B as x}from"./index-HfrO64ci.js";import{_ as z}from"./uni-search-bar.DPACRxvY.js";import{g as B}from"./index.qscmTMIl.js";import{P as F}from"./product-spec-popup.B3yT7R12.js";import"./uni-icons.dq1dDhWq.js";const I=x(a({__name:"selected",setup(a){e((()=>{O()})),l((()=>{G()}));const x=s(1),I=s([]),O=async()=>{try{const a=await B("/sel/tag");I.value=a.tag,A(x.value,I.value[0].id)}catch(a){console.error("获取失败")}},P=s([]),q=s(0),A=async(a,e)=>{try{const l=await B("/sel/products",{page:a,category_id:e});P.value=1==a?l.list:[...P.value,...l.list],q.value=l.pagination.totalPages,x.value=a}catch(l){console.error(l)}},D=s(0);t((()=>{console.log("触底了"),x.value<q.value&&A(x.value+1,I.value[D.value].id)}));const E=s(0),G=async()=>{try{const a=await B("/cart/list");E.value=a.length}catch(a){}},H=()=>{m("token")?y({url:"/pages/cart/cart"}):y({url:"/pages/login/login"})},J=s(!1),N=s({}),S=()=>{J.value=!1,G()};return(a,e)=>{const l=c(o("uni-search-bar"),z),s=h,t=k,m=j,B=b,O=c(o("up-icon"),w);return u(),r(d,null,[n(s,{class:"container"},{default:i((()=>[n(s,{class:"header"},{default:i((()=>[n(s,{class:"nav-content"},{default:i((()=>[n(l,{radius:"100",placeholder:"猫粮狗粮、宠物零食",clearButton:"none",cancelButton:"none",style:{width:"100%"}})])),_:1})])),_:1}),n(s,{class:"content"},{default:i((()=>[n(s,{class:"category-section"},{default:i((()=>[n(t,{class:"category-left","scroll-y":""},{default:i((()=>[(u(!0),r(d,null,p(I.value,((a,e)=>(u(),g(s,{key:a.id,class:C(["category-item",{active:D.value===e}]),onClick:l=>((a,e)=>{D.value=a,x.value=1,P.value=[],A(x.value,e)})(e,a.id)},{default:i((()=>[v(f(a.category_name),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),n(t,{"scroll-y":"",class:"category-right"},{default:i((()=>[n(s,{class:"category-title"},{default:i((()=>[v(f(I.value.length>0?I.value[D.value].category_name:"暂无数据"),1)])),_:1}),n(s,{class:"product-list"},{default:i((()=>[(u(!0),r(d,null,p(P.value,(a=>(u(),g(s,{class:"product-item",key:a.id},{default:i((()=>[n(m,{src:a.main_pic,mode:"aspectFill",class:"product-image",onClick:e=>{return l=a,void y({url:`/packageA/product-detail/product-detail?product=${JSON.stringify(l)}`});var l}},null,8,["src","onClick"]),n(s,{class:"product-info"},{default:i((()=>[n(B,{class:"product-name"},{default:i((()=>[v(f(a.name),1)])),_:2},1024),n(s,{class:"price-row"},{default:i((()=>[n(B,{class:"product-price"},{default:i((()=>[v("￥"+f(a.price),1)])),_:2},1024),n(s,{class:"add-cart",onClick:e=>{return l=a,J.value=!0,void(N.value=l);var l}},{default:i((()=>[n(O,{name:"shopping-cart",color:"#fff",size:"18"})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),n(s,{class:"float-cart",onClick:H},{default:i((()=>[n(O,{name:"shopping-cart",color:"#ffce2c",size:"80rpx"}),E.value>0?(u(),g(s,{key:0,class:"cart-badge"},{default:i((()=>[v(f(E.value),1)])),_:1})):_("",!0)])),_:1}),n(F,{show:J.value,product:N.value,onClose:S,showOk:!1},null,8,["show","product"])],64)}}}),[["__scopeId","data-v-da89b173"]]);export{I as default};
