{"version":3,"file":"product-detail.js","sources":["packageA/product-detail/product-detail.vue","../../../softawres/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFja2FnZUFccHJvZHVjdC1kZXRhaWxccHJvZHVjdC1kZXRhaWwudnVl"],"sourcesContent":["<template>\r\n\t<view class=\"product-detail\">\r\n\t\t<swiper class=\"swiper\" circular indicator-dots autoplay :interval=\"3000\" :duration=\"1000\">\r\n\t\t\t<swiper-item v-for=\"(item) in productImages\" :key=\"item.id\">\r\n\t\t\t\t<image :src=\"item.img_url\" mode=\"aspectFill\"></image>\r\n\t\t\t</swiper-item>\r\n\t\t</swiper>\r\n\t\t<!--商品信息-->\r\n\t\t<view class=\"product-info\">\r\n\t\t\t<view class=\"price-box\">\r\n\t\t\t\t<text class=\"price\">￥{{productInfo.price}}</text>\r\n\t\t\t\t<text class=\"original-price\">￥{{productInfo.o_price}}</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"title\">{{productInfo.name}}</view>\r\n\t\t\t<view class=\"desc\">{{productInfo.desc}}</view>\r\n\t\t</view>\r\n\t\t<!--规格选择-->\r\n\t\t<view class=\"spec-section\" @click=\"showSpecPopup\">\r\n\t\t\t<text class=\"label\">规格</text>\r\n\t\t\t<view class=\"selected-spec\">\r\n\t\t\t\t<text>{{selectedSpec || \"请选择规格\"}}</text>\r\n\t\t\t\t<up-icon name=\"arrow-right\" size=\"20\" color=\"#999\"></up-icon>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<!--商品详情-->\r\n\t\t<view class=\"detail-section\">\r\n\t\t\t<view class=\"section-title\">商品详情</view>\r\n\t\t\t<view class=\"detail-content\">\r\n\t\t\t\t<image \r\n\t\t\t\t\tv-for=\"item in productImages\"\r\n\t\t\t\t\t:key=\"item.id\"\r\n\t\t\t\t\tmode=\"widthFix\"\r\n\t\t\t\t\tclass=\"detail-image\"\r\n\t\t\t\t\t:src=\"item.img_url\"\r\n\t\t\t\t\t\r\n\t\t\t\t></image>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<!--底部操作区域-->\r\n\t\t<view class=\"bottom-bar\">\r\n\t\t\t<view class=\"left-btns\">\r\n\t\t\t\t<view class=\"icon-btn\" @click=\"goHome\">\r\n\t\t\t\t\t<up-icon name=\"home\" size=\"40\" color=\"#666\"></up-icon>\r\n\t\t\t\t\t<text >首页</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"icon-btn\" @click=\"goCart\">\r\n\t\t\t\t\t<up-icon name=\"shopping-cart\" size=\"40\" color=\"#666\"></up-icon>\r\n\t\t\t\t\t<text>购物车</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"right-btns\">\r\n\t\t\t\t<view class=\"cart-btn\" @click=\"addCart\">加入购物车</view>\r\n\t\t\t\t<view class=\"buy-btn\" @click=\"buyNow\">立即购买</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<ProductSpecPopup :show=\"show\" :product=\"productInfo\" @close=\"handleClose\" :showOk=\"true\"></ProductSpecPopup>\r\n\t</view>\n</template>\n\n<script setup lang=\"ts\">\r\n\timport {ref,computed} from \"vue\"\r\n\timport {onLoad} from \"@dcloudio/uni-app\"\r\n\timport { get,post } from \"../../utils/http\";\r\n\timport { useSpecStore } from \"../../store/spec\";\r\n\timport ProductSpecPopup from \"../../components/products-spec-popup/product-spec-popup.vue\";\r\n\tinterface ProductDetail{\r\n\t\tid:number;\r\n\t\tname:string;\r\n\t\tprice:string;\r\n\t\tstock:number;\r\n\t\tcategory_id:number;\r\n\t\tmain_pic:string;\r\n\t\tdesc:string;\r\n\t\to_price:string;\r\n\t}\r\n\tinterface ProductImage{\r\n\t\tid:number;\r\n\t\tproduct_id:number;\r\n\t\timg_url:string\r\n\t}\r\n\tconst specStore=useSpecStore()\r\n\tonLoad((options)=>{\r\n\t\tproductInfo.value= JSON.parse(options.product)\r\n\t\tgetImages();\r\n\t\tspecStore.setSpec(\"\")\r\n\t\tspecStore.setCount(1)\r\n\t})\r\n\t//商品数据\r\n\tconst productInfo=ref<ProductDetail>({} as ProductDetail)\r\n\tconst productImages=ref<ProductImage[]>([])\r\n\tconst getImages=async ()=>{\r\n\t\ttry {\r\n\t\t\tconst res:any=await get(\"/sel/detail\",{id:productInfo.value.id})\r\n\t\t\tproductImages.value=res\r\n\t\t} catch (error) {\r\n\t\t\tuni.__f__('error','at packageA/product-detail/product-detail.vue:96',\"失败\")\r\n\t\t}\r\n\t}\r\n\t//规格弹窗\r\n\tconst show=ref<boolean>(false)\r\n\tconst showSpecPopup=()=>{\r\n\t\tshow.value=true\r\n\t}\r\n\tconst handleClose=()=>{\r\n\t\tshow.value=false\r\n\t}\r\n\t//从pinia中取出规格数据\r\n\tconst selectedSpec=computed(()=>{\r\n\t\treturn specStore.specText\r\n\t})\r\n\tconst selCount=computed(()=>{\r\n\t\treturn specStore.count\r\n\t})\r\n\tconst selTotal=computed(()=>{\r\n\t\treturn specStore.total\r\n\t})\r\n\tconst addCart=async ()=>{\r\n\t\tif(selectedSpec.value){\r\n\t\t\ttry {\r\n\t\t\t\tconst res=await post(\"/cart/addCart\",{\r\n\t\t\t\t\tproduct_id:productInfo.value.id,\r\n\t\t\t\t\tname:productInfo.value.name,\r\n\t\t\t\t\tprice:productInfo.value.price,\r\n\t\t\t\t\tcount:selCount.value,\r\n\t\t\t\t\tspec:selectedSpec.value,\r\n\t\t\t\t\tmain_pic:productInfo.value.main_pic\r\n\t\t\t\t})\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle:\"加购成功\",\r\n\t\t\t\t\ticon:\"success\"\r\n\t\t\t\t})\r\n\t\t\t\tspecStore.setSpec(\"\")\r\n\t\t\t\tspecStore.setCount(1)\r\n\t\t\t\thandleClose()\r\n\t\t\t} catch (error) {\r\n\t\t\t\t//TODO handle the exception\r\n\t\t\t\tuni.__f__('error','at packageA/product-detail/product-detail.vue:137',error)\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\tshowSpecPopup()\r\n\t\t}\r\n\t}\r\n\t\r\n\r\n\t\r\n\tconst buyNow=()=>{\r\n\t\tif(selectedSpec.value){\r\n\t\t\tlet selPro=[{\r\n\t\t\t\tcount:selCount.value,\r\n\t\t\t\tmain_pic:productInfo.value.main_pic,\r\n\t\t\t\tname:productInfo.value.name,\r\n\t\t\t\tprice:selTotal.value,\r\n\t\t\t\tproduct_id:productInfo.value.id,\r\n\t\t\t\tspec:selectedSpec.value\r\n\t\t\t}]\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl:\"/packageB/order/order?selPro=\"+JSON.stringify(selPro)\r\n\t\t\t})\r\n\t\t}else{\r\n\t\t\tshowSpecPopup()\r\n\t\t}\r\n\t}\r\n\t\r\n\tconst goHome=()=>{\r\n\t\tuni.switchTab({\r\n\t\t\turl:\"/pages/index/index\"\r\n\t\t})\r\n\t}\r\n\tconst goCart=()=>{\r\n\t\t\r\n\t\tconst token=uni.getStorageSync(\"token\");\r\n\t\tif(!token){\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl:\"/pages/login/login\"\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\t\tuni.navigateTo({\r\n\t\t\turl:\"/pages/cart/cart\"\r\n\t\t})\r\n\t}\n</script>\n\n<style lang=\"scss\" scoped>\r\n\t.product-detail{\r\n\t\tmin-height: 100vh;\r\n\t\tbackground-color: #f5f5f5;\r\n\t\tpadding-bottom: 120rpx;\r\n\t\t.swiper{\r\n\t\t\twidth: 100%;\r\n\t\t\theight: 750rpx;\r\n\t\t\timage{\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\theight:100% ;\r\n\t\t\t}\r\n\t\t}\r\n\t\t.product-info{\r\n\t\t\tbackground-color: #fff;\r\n\t\t\tpadding: 30rpx;\r\n\t\t\tmargin-bottom: 20rpx;\r\n\t\t\t.price-box{\r\n\t\t\t\tmargin-bottom: 20rpx;\r\n\t\t\t\t.price{\r\n\t\t\t\t\tcolor: #ff6b81;\r\n\t\t\t\t\tfont-size: 40rpx;\r\n\t\t\t\t\tfont-weight: bold;\r\n\t\t\t\t\tmargin-right: 20rpx;\r\n\t\t\t\t}\r\n\t\t\t\t.original-price{\r\n\t\t\t\t\tcolor:#999;\r\n\t\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\t\ttext-decoration: line-through;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t.title{\r\n\t\t\t\tfont-size: 32rpx;\r\n\t\t\t\tfont-weight: bold;\r\n\t\t\t\tcolor:#333;\r\n\t\t\t\tmargin-bottom: 16rpx;\r\n\t\t\t}\r\n\t\t\t.desc{\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tcolor: #666;\r\n\t\t\t\tline-height: 1.6;\r\n\t\t\t}\r\n\t\t}\r\n\t\t.spec-section{\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\tbackground-color: #fff;\r\n\t\t\tpadding: 30rpx;\r\n\t\t\tmargin-bottom: 20rpx;\r\n\t\t\tjustify-content: space-between;\r\n\t\t\t.label{\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tcolor: #333;\r\n\t\t\t}\r\n\t\t\t.selected-spec{\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tcolor: #666;\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\ttext{\r\n\t\t\t\t\tmargin-right: 10rpx;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t.detail-section{\r\n\t\t\tbackground-color: #fff;\r\n\t\t\tpadding: 30rpx;\r\n\t\t\t.section-title{\r\n\t\t\t\tfont-size: 32rpx;\r\n\t\t\t\tfont-weight: bold;\r\n\t\t\t\tcolor: #333;\r\n\t\t\t\tmargin-bottom: 30rpx;\r\n\t\t\t}\r\n\t\t\t.detail-content{\r\n\t\t\t\tpadding: 20rpx;\r\n\t\t\t\t.detail-image{\r\n\t\t\t\t\twidth: 100%;\r\n\t\t\t\t\tmargin-bottom: 20rpx;\r\n\t\t\t\t\tborder-radius: 12rpx;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t.bottom-bar{\r\n\t\t\tposition: fixed;\r\n\t\t\tbottom: 0;\r\n\t\t\tleft: 0;\r\n\t\t\tright: 0;\r\n\t\t\theight: 60rpx;\r\n\t\t\tbackground-color: #fff;\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\tpadding: 30rpx;\r\n\t\t\tbox-shadow: 0 -2rpx 10rpx rgba(0, 0, 0, 0.05);\r\n\t\t\t.left-btns{\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tmargin-right: 30rpx;\r\n\t\t\t\t.icon-btn{\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\tflex-direction: column;\r\n\t\t\t\t\talign-items: center;\r\n\t\t\t\t\tmargin-right: 30rpx;\r\n\t\t\t\t\ttext{\r\n\t\t\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\t\t\tcolor: #666;\r\n\t\t\t\t\t\tmargin-top: 4rpx;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t.right-btns{\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex: 1;\r\n\t\t\t\t.cart-btn,.buy-btn{\r\n\t\t\t\t\tflex: 1;\r\n\t\t\t\t\theight: 80rpx;\r\n\t\t\t\t\tborder-radius: 40rpx;\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\talign-items: center;\r\n\t\t\t\t\tjustify-content: center;\r\n\t\t\t\t\tfont-size: 32rpx;\r\n\t\t\t\t\tfont-weight: bold;\r\n\t\t\t\t}\r\n\t\t\t\t.cart-btn{\r\n\t\t\t\t\tbackground-color: #fff8e6;\r\n\t\t\t\t\tcolor: #ffce2c;\r\n\t\t\t\t\tmargin-right: 20rpx;\r\n\t\t\t\t}\r\n\t\t\t\t.buy-btn{\r\n\t\t\t\t\tbackground-color: #ffce2c;\r\n\t\t\t\t\tcolor: #fff;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t}\r\n\n</style>","import MiniProgramPage from 'D:/project/hakistar/hakistar/packageA/product-detail/product-detail.vue'\nwx.createPage(MiniProgramPage)"],"names":["useSpecStore","onLoad","ref","get","uni","computed","post"],"mappings":";;;;;;;;;;;;AAgEC,MAAA,mBAA6B,MAAA;;;;AAgB7B,UAAM,YAAUA,WAAAA;AAChBC,kBAAA,OAAO,CAAC,YAAU;AACjB,kBAAY,QAAO,KAAK,MAAM,QAAQ,OAAO;AACnC;AACV,gBAAU,QAAQ,EAAE;AACpB,gBAAU,SAAS,CAAC;AAAA,IAAA,CACpB;AAEK,UAAA,cAAYC,kBAAmB,CAAA,CAAmB;AAClD,UAAA,gBAAcA,kBAAoB,CAAA,CAAE;AAC1C,UAAM,YAAU,YAAU;AACrB,UAAA;AACG,cAAA,MAAQ,MAAMC,iBAAI,IAAA,eAAc,EAAC,IAAG,YAAY,MAAM,GAAA,CAAG;AAC/D,sBAAc,QAAM;AAAA,eACZ,OAAO;AACXC,sBAAAA,MAAA,MAAM,SAAQ,oDAAmD,IAAI;AAAA,MAC1E;AAAA,IAAA;AAGK,UAAA,OAAKF,kBAAa,KAAK;AAC7B,UAAM,gBAAc,MAAI;AACvB,WAAK,QAAM;AAAA,IAAA;AAEZ,UAAM,cAAY,MAAI;AACrB,WAAK,QAAM;AAAA,IAAA;AAGN,UAAA,eAAaG,cAAAA,SAAS,MAAI;AAC/B,aAAO,UAAU;AAAA,IAAA,CACjB;AACK,UAAA,WAASA,cAAAA,SAAS,MAAI;AAC3B,aAAO,UAAU;AAAA,IAAA,CACjB;AACK,UAAA,WAASA,cAAAA,SAAS,MAAI;AAC3B,aAAO,UAAU;AAAA,IAAA,CACjB;AACD,UAAM,UAAQ,YAAU;AACvB,UAAG,aAAa,OAAM;AACjB,YAAA;AACG,gBAAA,MAAI,MAAMC,iBAAA,KAAK,iBAAgB;AAAA,YACpC,YAAW,YAAY,MAAM;AAAA,YAC7B,MAAK,YAAY,MAAM;AAAA,YACvB,OAAM,YAAY,MAAM;AAAA,YACxB,OAAM,SAAS;AAAA,YACf,MAAK,aAAa;AAAA,YAClB,UAAS,YAAY,MAAM;AAAA,UAAA,CAC3B;AACDF,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAM;AAAA,YACN,MAAK;AAAA,UAAA,CACL;AACD,oBAAU,QAAQ,EAAE;AACpB,oBAAU,SAAS,CAAC;AACR;iBACJ,OAAO;AAEXA,wBAAAA,MAAA,MAAM,SAAQ,qDAAoD,KAAK;AAAA,QAC5E;AAAA,MAAA,OACI;AACU;MACf;AAAA,IAAA;AAKD,UAAM,SAAO,MAAI;AAChB,UAAG,aAAa,OAAM;AACrB,YAAI,SAAO,CAAC;AAAA,UACX,OAAM,SAAS;AAAA,UACf,UAAS,YAAY,MAAM;AAAA,UAC3B,MAAK,YAAY,MAAM;AAAA,UACvB,OAAM,SAAS;AAAA,UACf,YAAW,YAAY,MAAM;AAAA,UAC7B,MAAK,aAAa;AAAA,QAAA,CAClB;AACDA,sBAAAA,MAAI,WAAW;AAAA,UACd,KAAI,kCAAgC,KAAK,UAAU,MAAM;AAAA,QAAA,CACzD;AAAA,MAAA,OACG;AACU;MACf;AAAA,IAAA;AAGD,UAAM,SAAO,MAAI;AAChBA,oBAAAA,MAAI,UAAU;AAAA,QACb,KAAI;AAAA,MAAA,CACJ;AAAA,IAAA;AAEF,UAAM,SAAO,MAAI;AAEV,YAAA,QAAMA,cAAAA,MAAI,eAAe,OAAO;AACtC,UAAG,CAAC,OAAM;AACTA,sBAAAA,MAAI,WAAW;AAAA,UACd,KAAI;AAAA,QAAA,CACJ;AACD;AAAA,MACD;AACAA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAI;AAAA,MAAA,CACJ;AAAA,IAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClLH,GAAG,WAAW,eAAe;"}